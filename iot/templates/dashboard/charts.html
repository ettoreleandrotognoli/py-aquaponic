{% extends 'iot/main.html' %}
{% block extra_head %}
<style type="text/css">
    .dashboard [class*=col-] {
        padding: 0;
    }
</style>
{% endblock %}
{% block body %}
<div class="container dashboard">
    <div class="row">
        {% for sensor in sensor_list%}
        <div class="col-xs-12 col-sm-12 col-md-6 col-lg-4">
            <object type="image/svg+xml" data="{% url 'iot:sensor-chart' pk=sensor.pk %}?limit=10"
                    class="chart"></object>
        </div>
        {% endfor %}
    </div>
    <div class="row">
        {% for pid in pid_list%}
        <div class="col-xs-12 col-sm-12 col-md-6 col-lg-4">
            <object type="image/svg+xml" data="{% url 'iot:pid-chart' pk=pid.pk %}?limit=10" class="chart"></object>
        </div>
        {% endfor %}
    </div>
    <div class="row">
        {% for actuator in actuator_list%}
        <div class="col-xs-12 col-sm-12 col-md-6 col-lg-4">
            <object type="image/svg+xml" data="{% url 'iot:actuator-chart' pk=actuator.pk %}?limit=10"
                    class="chart"></object>
        </div>
        {% endfor %}
    </div>
</div>
<script type="text/javascript">
    $(function(){
        var ws = new WebSocket('ws:127.0.0.1:8000');
        ws.onmessage = function(event){
            $('.chart').each(function(){
                var oldChart = $(this);
                var newChart = oldChart.clone();
                oldChart[0].parentNode.replaceChild(newChart[0],oldChart[0]);
            });
        };
    });



</script>
{% endblock %}
